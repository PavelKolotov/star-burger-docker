# Сайт доставки еды Star Burger

Это сайт сети ресторанов [Star Burger](https://star-burger-docker.universal-web.online/). Здесь можно заказать превосходные бургеры с доставкой на дом.

![скриншот сайта](https://dvmn.org/filer/canonical/1594651635/686/)


Сеть Star Burger объединяет несколько ресторанов, действующих под единой франшизой. У всех ресторанов одинаковое меню и одинаковые цены. Просто выберите блюдо из меню на сайте и укажите место доставки. Мы сами найдём ближайший к вам ресторан, всё приготовим и привезём.

На сайте есть три независимых интерфейса. Первый — это публичная часть, где можно выбрать блюда из меню, и быстро оформить заказ без регистрации и SMS.

Второй интерфейс предназначен для менеджера. Здесь происходит обработка заказов. Менеджер видит поступившие новые заказы и первым делом созванивается с клиентом, чтобы подтвердить заказ. После оператор выбирает ближайший ресторан и передаёт туда заказ на исполнение. Там всё приготовят и сами доставят еду клиенту.

Третий интерфейс — это админка. Преимущественно им пользуются программисты при разработке сайта. Также сюда заходит менеджер, чтобы обновить меню ресторанов Star Burger.

## Как запустить Local-версию сайта

На локальной машине необходимо установить [Docker](https://docs.docker.com/), для запуска на локальной машине [Docker Desktop](https://docs.docker.com/desktop/).

Клонируйте репозиторий:
```sh
git clone https://github.com/PavelKolotov/star-burger-docker.git
```

Перейдите в корень каталога сайта:
```sh
cd star-burger-docker
```

Часть настроек проекта берётся из переменных окружения. Чтобы их определить, создайте файл `.env` и запишите туда данные в таком формате: `ПЕРЕМЕННАЯ=значение`.

- `ROLLBAR_ACCESS_TOKEN` — ваш ключ от [Rollbar](https://rollbar.com/)
- `ROLLBAR_ENVIRONMENT` — настройка environment в Rollbar задаёт название окружения или инсталляции сайта.
- `YANDEX_GEOCODER_API_KEY`- в [кабинете разработчика](https://developer.tech.yandex.ru/) в API JavaScript API и HTTP Геокодер получите ключ.

Для сборки и запуска контейнеров используйте команду:
```sh
docker-compose up
```
Эта команда сначала соберет образы из Dockerfile и затем запустит контейнеры.

После запуска контейнера сайт будет доступен по адресу [http://localhost:8080](http://localhost:8080)

## Как запустить production-версию сайта на VPS (Виртуальный частный сервер)

### Production окружение

Получите домен для приложения Star Burger.

На сервере необходимо:
- Установить [Docker](https://docs.docker.com/), для удалённых серверов следует использовать гайд по установке [Docker Engine](https://docs.docker.com/engine/install/).
- Установить и настроить на сервере nginx (пример конфига можно посмотреть в каталоге configs)
- Получить TLS сертификаты (для данного сайта использовался инструмент Certbot)
- Настроить юнит-файл в systemd для перезапуска ПО в случае перезагрузки сервера (пример конфига можно посмотреть в каталоге configs)

### Деплой

Клонируйте репозиторий на сервер:
```sh
git clone https://github.com/PavelKolotov/star-burger-docker.git
```

Перейдите в каталог c конфигурацией для production:
```sh
cd star-burger-docker/production_env
```

Часть настроек проекта берётся из переменных окружения. Чтобы их определить, создайте файл `.env` и запишите туда данные в таком формате: `ПЕРЕМЕННАЯ=значение`.

- `DEBUG` — дебаг-режим. Поставьте `False`.
- `SECRET_KEY` — секретный ключ проекта. Он отвечает за шифрование на сайте. Например, им зашифрованы все пароли на вашем сайте.
- `ALLOWED_HOSTS` — [см. документацию Django](https://docs.djangoproject.com/en/3.1/ref/settings/#allowed-hosts)
- `ROLLBAR_ACCESS_TOKEN` — ваш ключ от [Rollbar](https://rollbar.com/)
- `ROLLBAR_ENVIRONMENT` — настройка environment в Rollbar задаёт название окружения или инсталляции сайта.
- `DB_URL` - параметры подключения к БД в формате URL (postgres://<пользователь>:<пароль>@<хост>:<порт>/<имя_базы_данных>)
- `YANDEX_GEOCODER_API_KEY`- в [кабинете разработчика](https://developer.tech.yandex.ru/) в API JavaScript API и HTTP Геокодер получите ключ.
- `POSTGRES_USER` - параметр подключения к БД <пользователь>
- `POSTGRES_PASSWORD`- параметр подключения к БД <пароль>
- `POSTGRES_DB`- параметр подключения к БД <имя_базы_данных>

Для автоматического деплоя или обновления кода запустите bash-скрипт из каталога c конфигурацией для production:
```sh
./update_star_burger_docker.sh
```

После запуска контейнера сайт будет доступен по вашему адресу.

## Цели проекта

Код написан в учебных целях — это урок в курсе по Python и веб-разработке на сайте [Devman](https://dvmn.org). За основу был взят код проекта [FoodCart](https://github.com/Saibharath79/FoodCart).
